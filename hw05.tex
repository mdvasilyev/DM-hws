%! suppress = Makeatletter
%! suppress = TooLargeSection
%! suppress = MissingLabel
\documentclass{article}

% Fields
\usepackage{geometry}
\geometry{top=25mm}
\geometry{bottom=35mm}
\geometry{left=20mm}
\geometry{right=20mm}
% ------------------------------------------------

% Graphics
\usepackage{color}
\usepackage{tabularx}
\usepackage{tikz}
\usepackage{blkarray}
\usepackage{graphicx}
% ------------------------------------------------

% Math
\usepackage{amsmath, amsfonts}
\usepackage{amssymb}
\usepackage{proof}
\usepackage{mathrsfs}
% Crossed-out symbols
% https://tex.stackexchange.com/questions/75525/how-to-write-crossed-out-math-in-latex
\usepackage[makeroom]{cancel}
\usepackage{mathtools}
% ------------------------------------------------

% Additional font sizes
% https://www.overleaf.com/learn/latex/Questions/How_do_I_adjust_the_font_size%3F
\usepackage{moresize}
% Additional colors
% https://www.overleaf.com/learn/latex/Using_colours_in_LaTeX
\usepackage{xcolor}
% \texttimes
\usepackage{textcomp}
% ------------------------------------------------

% Language
\usepackage[utf8] {inputenc}
\usepackage[T2A] {fontenc}
\usepackage[english, russian] {babel}
\usepackage{indentfirst, verbatim}
\usetikzlibrary{cd, babel}
% ------------------------------------------------

% Fonts
\usepackage{stmaryrd}
\usepackage{cmbright}
\usepackage{wasysym}
% ------------------------------------------------

% Code
% https://tex.stackexchange.com/questions/99475/how-to-invoke-latex-with-the-shell-escape-flag-in-texstudio-former-texmakerx
% Colored, requires --shell-escape compiling option
% \usepackage{minted}
% \setminted{xleftmargin=\parindent, autogobble, escapeinside=\#\#}
\usepackage{listings}
% ------------------------------------------------

% Custom envs
% https://tex.stackexchange.com/questions/371286/draw-a-horizontal-line-in-latex
\newenvironment{proof}{\subparagraph{\hspace{-1em}Решение:\newline}}{\par\noindent\rule{\textwidth}{0.4pt}}
% ------------------------------------------------

% Custom commands
\newcommand{\comb}[1]{\mathbf{#1}}
\newcommand{\step}{\rightsquigarrow}
\newcommand{\term}[1]{\mathbf{#1}}
\newcommand{\ap}{~}
\newcommand{\termdef}{\coloneqq}
\newcommand{\subst}[3]{\left[#2 \mapsto #3 \right] #1}
\newcommand{\eqbeta}{=_\beta}
\newcommand{\eqeta}{=_\eta}
\def\multiset#1#2{\ensuremath{\left(\kern-.3em\left(\genfrac{}{}{0pt}{}{#1}{#2}\right)\kern-.3em\right)}}
% ------------------------------------------------

% Head
\usepackage{fancybox,fancyhdr}
\usepackage{hyperref}
\pagestyle{fancy}
\fancyhead[R]{Максим Васильев (285800)} % TODO введите ваше имя
\fancyhead[L]{ИТМО MSE, ДМ 2023, Дз 5}
% ------------------------------------------------

% Numbering
% https://tex.stackexchange.com/questions/80113/hide-section-numbers-but-keep-numbering
\makeatletter
\renewcommand\thesubsection{Блок \@arabic\c@subsection.\hspace{-0.8em}}
\renewcommand\thesubsubsection{Задание \@arabic\c@subsection.\@arabic\c@subsubsection\hspace{-0.8em}}
% https://tex.stackexchange.com/questions/327689/numbering-subsubsections-with-letters
\renewcommand\theparagraph{\alph{paragraph})\hspace{-0.8em}}
% https://tex.stackexchange.com/questions/129208/numbering-paragraphs-in-latex
\setcounter{secnumdepth}{4}
\makeatother
% ------------------------------------------------

\begin{document}

  \begin{enumerate}
    \item \textit{(0,5 балла)} Найдите общее решение линейного однородного рекуррентного соотношения второго порядка:
    $$a_{n+2} = -3 a_{n+1} + 10 a_n$$
    \textbf{Решение}:
    
    Запишем характеристическое уравнение:
    \begin{equation}
      \lambda^2 + 3\lambda - 10 = 0
    \end{equation}
    Корни:
    \begin{equation}
      \lambda = \begin{cases}
        -5 \\
        2
      \end{cases}
    \end{equation}
    Тогда общее решение строится как:
    \begin{equation}
      a_n = C_1 \cdot (-5)^n + C_2 \cdot 2^n.
    \end{equation}

    \textbf{Ответ}:
    $a_n = C_1 \cdot (-5)^n + C_2 \cdot 2^n.$

    \item \textit{(а) 1 балл; (б) 2 балла} Решите следующие линейные однородные рекуррентные соотношения второго порядка:
    
    а) $a_{n+2} = -6a_{n+1} - 9a_n, a_0 = 2, a_1 = 6;$

    \textbf{Решение}:

    Запишем характеристическое уравнение:
    \begin{equation}
      \lambda^2 + 6\lambda + 9 = (\lambda + 3)^2 = 0
    \end{equation}
    Здесь один кратный корень ($-3$) второй степени и общее решение строится как
    \begin{equation}
      a_n = C_1 \cdot (-3)^n + C_2 \cdot n \cdot (-3)^n.
    \end{equation}
    Подставим начальные условия:
    \begin{equation}
      \begin{cases}
        0 = a_0 = C_1 \\
        6 = a_1 = C_1 \cdot (-3) + C_2 \cdot (-3)
      \end{cases}
    \end{equation}
    Из системы получаем, что
    \begin{equation}
      \begin{cases}
        C_1 = 0 \\
        C_2 = -2
      \end{cases}
    \end{equation}
    Тогда общее решение:
    \begin{equation}
      a_n = -2 \cdot n \cdot (-3)^n
    \end{equation}

    \textbf{Ответ}:
    $a_n = -2 \cdot n \cdot (-3)^n.$
    
    б) $a_{n+2} = 2\sqrt{2}a_{n+1} - 4a_n, a_0 = 1, a_1 = 2.$

    \textbf{Решение}:

    Запишем характеристическое уравнение:
    \begin{equation}
      \lambda^2 - 2\sqrt{2} \lambda + 4 = 0
    \end{equation}
    Корни:
    \begin{equation}
      \lambda = \begin{cases}
        \sqrt{2} (1-i) \\
        \sqrt{2} (1+i)
      \end{cases}
    \end{equation}
    Тогда общее решение строится как:
    \begin{equation}
      a_n = C_1 \cdot \sqrt{2}^n (1-i)^n + C_2 \cdot \sqrt{2}^n (1+i)^n = C_1 \cdot 2^n \cdot \left(\frac{1}{\sqrt{2}}-\frac{i}{\sqrt{2}}\right)^n + C_2 \cdot 2^n \cdot \left(\frac{1}{\sqrt{2}}+\frac{i}{\sqrt{2}}\right)^n.
    \end{equation}
    Сведем к тригонометрическим функциям (тут будет угол $\pi/4$):
    \begin{equation}
      a_n = 2^n \cdot \left(C_1 \cos \frac{\pi n}{4} + C_2 \sin \frac{\pi n}{4}\right)
    \end{equation}
    Подставим начальные условия:
    \begin{equation}
      \begin{cases}
        1 = a_0 = C_1 \\
        2 = a_1 = 2 \cdot (C_1 \cdot \sqrt{2}/2 + C_2 \cdot \sqrt{2}/2) = (C_1 \cdot \sqrt{2} + C_2 \cdot \sqrt{2})
      \end{cases}
    \end{equation}
    Из системы получаем, что
    \begin{equation}
      \begin{cases}
        C_1 = 1 \\
        C_2 = \frac{1}{\sqrt{2}} - 1
      \end{cases}
    \end{equation}
    Тогда общее решение:
    \begin{equation}
      a_n = 2^n \cdot \left(\cos \frac{\pi n}{4} + \left(\frac{1}{\sqrt{2}} - 1\right) \sin \frac{\pi n}{4}\right)
    \end{equation}

    \textbf{Ответ}:
    $a_n = 2^n \cdot \left(\cos \frac{\pi n}{4} + \left(\frac{1}{\sqrt{2}} - 1\right) \sin \frac{\pi n}{4}\right)$

    \item \textit{(1,5 балла)} Постройте общее решение неоднородного рекуррентного соотношения второго порядка:
    $$a_{n+2} = 5a_{n+1} - 6a_n + 3 · 2n.$$
    \item \textit{(1 балл)} Ира положила тысячу рублей в банк под четыре процента годовых. В начале каждого года она докладывает восемьсот рублей на счет. Сколько денег будет на счете через n лет?
  \end{enumerate}

\end{document}
