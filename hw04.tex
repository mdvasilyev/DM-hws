%! suppress = Makeatletter
%! suppress = TooLargeSection
%! suppress = MissingLabel
\documentclass{article}

% Fields
\usepackage{geometry}
\geometry{top=25mm}
\geometry{bottom=35mm}
\geometry{left=20mm}
\geometry{right=20mm}
% ------------------------------------------------

% Graphics
\usepackage{color}
\usepackage{tabularx}
\usepackage{tikz}
\usepackage{blkarray}
\usepackage{graphicx}
% ------------------------------------------------

% Math
\usepackage{amsmath, amsfonts}
\usepackage{amssymb}
\usepackage{proof}
\usepackage{mathrsfs}
% Crossed-out symbols
% https://tex.stackexchange.com/questions/75525/how-to-write-crossed-out-math-in-latex
\usepackage[makeroom]{cancel}
\usepackage{mathtools}
% ------------------------------------------------

% Additional font sizes
% https://www.overleaf.com/learn/latex/Questions/How_do_I_adjust_the_font_size%3F
\usepackage{moresize}
% Additional colors
% https://www.overleaf.com/learn/latex/Using_colours_in_LaTeX
\usepackage{xcolor}
% \texttimes
\usepackage{textcomp}
% ------------------------------------------------

% Language
\usepackage[utf8] {inputenc}
\usepackage[T2A] {fontenc}
\usepackage[english, russian] {babel}
\usepackage{indentfirst, verbatim}
\usetikzlibrary{cd, babel}
% ------------------------------------------------

% Fonts
\usepackage{stmaryrd}
\usepackage{cmbright}
\usepackage{wasysym}
% ------------------------------------------------

% Code
% https://tex.stackexchange.com/questions/99475/how-to-invoke-latex-with-the-shell-escape-flag-in-texstudio-former-texmakerx
% Colored, requires --shell-escape compiling option
% \usepackage{minted}
% \setminted{xleftmargin=\parindent, autogobble, escapeinside=\#\#}
\usepackage{listings}
% ------------------------------------------------

% Custom envs
% https://tex.stackexchange.com/questions/371286/draw-a-horizontal-line-in-latex
\newenvironment{proof}{\subparagraph{\hspace{-1em}Решение:\newline}}{\par\noindent\rule{\textwidth}{0.4pt}}
% ------------------------------------------------

% Custom commands
\newcommand{\comb}[1]{\mathbf{#1}}
\newcommand{\step}{\rightsquigarrow}
\newcommand{\term}[1]{\mathbf{#1}}
\newcommand{\ap}{~}
\newcommand{\termdef}{\coloneqq}
\newcommand{\subst}[3]{\left[#2 \mapsto #3 \right] #1}
\newcommand{\eqbeta}{=_\beta}
\newcommand{\eqeta}{=_\eta}
\def\multiset#1#2{\ensuremath{\left(\kern-.3em\left(\genfrac{}{}{0pt}{}{#1}{#2}\right)\kern-.3em\right)}}
% ------------------------------------------------

% Head
\usepackage{fancybox,fancyhdr}
\usepackage{hyperref}
\pagestyle{fancy}
\fancyhead[R]{Максим Васильев (285800)} % TODO введите ваше имя
\fancyhead[L]{ИТМО MSE, ДМ 2023, Дз 4}
% ------------------------------------------------

% Numbering
% https://tex.stackexchange.com/questions/80113/hide-section-numbers-but-keep-numbering
\makeatletter
\renewcommand\thesubsection{Блок \@arabic\c@subsection.\hspace{-0.8em}}
\renewcommand\thesubsubsection{Задание \@arabic\c@subsection.\@arabic\c@subsubsection\hspace{-0.8em}}
% https://tex.stackexchange.com/questions/327689/numbering-subsubsections-with-letters
\renewcommand\theparagraph{\alph{paragraph})\hspace{-0.8em}}
% https://tex.stackexchange.com/questions/129208/numbering-paragraphs-in-latex
\setcounter{secnumdepth}{4}
\makeatother
% ------------------------------------------------

\begin{document}

\begin{enumerate}

    \item \textit{(1 балл)} Команда из четырех участников одержала победу на математическом турнире. В подарок участники команды получили 7 различных книг. Сколькими способами ребята могут разделить эти книги между собой так, чтобы каждому досталась хотя бы одна книга? (\textit{Ответ найти численно.})
    
    \textbf{Решение}:
    
    По определению это будет:
    \begin{equation}
        \widehat{S}(7,4) = 4! \cdot S(7,4).
    \end{equation}
    Из таблицы
    \begin{equation}
        S(7,4) = 350 \quad \Rightarrow \quad \widehat{S}(7,4) = 24 \cdot 350 = 8400.
    \end{equation}

    \textbf{Ответ}:
    8400

    \item \textit{(1,5 балла)} Найти сумму четырехзначных чисел, которые можно получить при всевозможных перестановках цифр 1, 5, 9, 9.

    \textbf{Решение}:

    Заметим, что у нас две одинаковые цифры, которые мы различить не можем. Разобъем задачу на разряды:
    \begin{itemize}
        \item Для тысяч: если на первом месте стоит 1 или 5, то для оставшихся мест всего 3 различных варианта, потому что есть две одинаковые цифры. Если на первом месте стоит 9, то на для оставшихся мест существует 6 различных вариантов. В сумме будет:
        \begin{equation}
            (1 + 5) \cdot 3 \cdot 1000 + 9 \cdot 6 \cdot 1000 = ((1 + 5) \cdot 3 + 9 \cdot 6) \cdot 1000.
        \end{equation}
        \item Для сотен, десяток и единиц размышления аналогичные:
        \begin{equation}
            ((1 + 5) \cdot 3 + 9 \cdot 6) \cdot (100 + 10 + 1).
        \end{equation}
    \end{itemize}
    Поэтому сумма четырехзначных чисел, которые можно получить при всевозможных перестановках цифр 1, 5, 9, 9, будет равна
    \begin{equation}
        ((1 + 5) \cdot 3 + 9 \cdot 6) \cdot (1000 + 100 + 10 + 1).
    \end{equation}
    
    \textbf{Ответ}:
    $((1 + 5) \cdot 3 + 9 \cdot 6) \cdot (1000 + 100 + 10 + 1)$

    
    \item \textit{(1,5 балла)} Чему равно количество способов, которыми тренер может разделить 28 мальчиков на 4 команды по 7 человек?
    
    \textbf{Решение}:

    Мальчики различимы, а команды нет. Количество способов выбрать семерку мальчиков из общего количества для первой команды:
    \begin{equation}
        \binom{28}{7}.
    \end{equation}
    Осталось собрать еще 3 команды. Вариантов выбрать вторую команду:
    \begin{equation}
        \binom{21}{7}.
    \end{equation}
    Вариантов выбрать третью команду:
    \begin{equation}
        \binom{14}{7}.
    \end{equation}
    Четвертая команда собирается автоматически. Поэтому всего вариантов, которыми тренер может разделить 28 мальчиков на 4 команды по 7 человек:
    \begin{equation}
        \binom{28}{7} \cdot \binom{21}{7} \cdot \binom{14}{7}.
    \end{equation}

    \textbf{Ответ}:
    $\binom{28}{7} \cdot \binom{21}{7} \cdot \binom{14}{7}$
   
    \item \textit{(1,5 балла)} Докажите, что числа Стирлинга $S(n,n-2)$ рассчитываются по формуле:
    $$S(n,n-2)=\frac{n(n-1)(n-2)(3n-5)}{24}.$$

    \textbf{Решение}:

    Такое число Стирлинга можно удовлетворить двумя ситуациями:
    \begin{itemize}
        \item Из n выбрать тройку и поместить эту тройку в один ящик, остальные заполняются по одному элементу:
        \begin{equation}
            \binom{n}{3} = \frac{n \cdot (n-1) \cdot (n-2)}{6}.
        \end{equation}
        \item Из n выбрать двойку и поместить эту двойку в один ящик, а потом из $n-2$ выбрать еще одну двойку и поместить ее в другой ящик, остальные заполняются автоматически. Так как нам не важен порядок этих пар, то нужно поделить на число перестановок:
        \begin{equation}
            \frac{1}{2!}\binom{n}{2}\binom{n-2}{2} = \frac{1}{2}\cdot\frac{n \cdot (n-1)}{2} \cdot \frac{(n-2) \cdot (n-3)}{2} = \frac{n \cdot (n-1)\cdot(n-2) \cdot (n-3)}{8}.
        \end{equation}
    \end{itemize}
    Так как ситации ?независимы?, то результат представляет собой сумму вариантов:
    \begin{equation}
        S(n,3) = \binom{n}{3} + \frac{1}{2!}\binom{n}{2}\binom{n-2}{2} = n \cdot (n-1) \cdot (n-2) \cdot \left(\frac{n-3}{8} + \frac{1}{6}\right) = \frac{n(n-1)(n-2)(3n-5)}{24}.
    \end{equation}


    \begin{flushright}
        $\blacksquare$
    \end{flushright}

    
    \item \textit{(1,5 балла)} Докажите (\textit{не пользуясь формулой для $\hat{S}(n,k)$}), что числа Стирлинга $S(n,3)$ рассчитываются по формуле:
    $$S(n,3)=\frac{3^n-3(2^n-2)-3}{6}.$$

    
    \textbf{Решение}:

    Всего вариантов разложить n предметов по 3 ящикам:
    \begin{equation}
        3^n.
    \end{equation}
    Вычтем варианты, когда один ящик пустой:
    \begin{equation}
        2^n - 2.
    \end{equation}
    Эту формулу получали на практике. Здесь мы смотрим все варианты распределить n предметов по 2 ящикам без учета тех вариантов, когда один из ящиков может быть пустым. Если теперь вспомнить, что в исходной задаче у нас 3 ящика, то $2^n - 2$ надо домножить на 3, потому что именно столько вариантов выбрать 2 предмета из 3.

    Теперь вычтем варианты, когда два из трех ящиков могут быть пустыми. Получается:
    \begin{equation}
        3^n-3(2^n-2)-3.
    \end{equation}
    Так как нам не важен порядок, то поделим на число перестановок ящиков:
    \begin{equation}
        \frac{3^n-3(2^n-2)-3}{3!}.
    \end{equation}
    Получили, что
    \begin{equation}
        S(n,3)=\frac{3^n-3(2^n-2)-3}{3!} = \frac{3^n-3(2^n-2)-3}{6}.
    \end{equation}
    \begin{flushright}
        $\blacksquare$
    \end{flushright}
    
    % \item \textit{(2 балла)} Докажите, что для всех $n\geq3$ числа Белла $B(n)<n!$.
    
    % \item \textit{(3 балла)} Обозначим через $F(n)$ количество разбиений $n$-множества без блоков единичной длины. Докажите, что $B(n) = F(n) + F(n+1)$.
    
    \end{enumerate}

\end{document}
